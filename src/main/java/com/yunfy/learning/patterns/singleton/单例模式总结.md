# 单例模式

标签: 设计模式

---

## 饿汉式

* 优点

> 无需考虑线程安全问题  
> 获取对象快

* 缺点

> 类加载时就初始化，占用空间

## 懒汉式（简单版本）

* 优点

> 用户在调用时才初始化，节约资源

* 缺点

> 第一次加载时需要实例化，反映稍慢一些  
> 多线程情况不能正常工作

## 懒汉式（双重检查锁）

* 优点

> 解决简单版本的线程安全问题

* 缺点

> 锁的存在可能影响性能

## 静态内部类式

* 优点

> 只有第一次调用getInstance方法时虚拟机加载内部类，并初始化Instance

## 枚举式

* 优点

> 默认枚举实例的创建是线程安全的，并且在任何情况下都是单例
> 不被反射和序列化破坏

## 注册式

* 优点

> 可以管理多种类型的单例，并且在使用时通过统一的接口进行获取操作，降低了用户的使用成本，也对用户隐藏了具体实现，降低了耦合度

## 破坏单例模式的方式

* 反射破坏

 > 通过反射获取无参构造器，通过setAccessible(true)破坏private
 > 可以通过在构造器中判断实例是否为null，决定是否抛出异常，从而防止被破坏

* 序列化破坏

 > 通过序列化写入并反序列化读取，可破坏单例
 > 可以通过在单例中加入readResolve解决

## 静态内部类

* 当被外部调用时才加载，只调用外部类的变量时不加载内部类
* 不能使用任何外部类的非static成员变量和方法
